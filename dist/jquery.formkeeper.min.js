/*
 *  formkeeper - v1.0.0
 *  Using localStorage backup and restore form data
 *  
 *
 *  Made by 
 *  Under NoLicense License
 */
!function(a,b,c,d,e){function f(d,e){return this.element=d,this.options=b.extend({backupForm:b.fn.formKeeper.backupForm,restoreForm:b.fn.formKeeper.restoreForm,backupData:b.fn.formKeeper.backupData,restoreData:b.fn.formKeeper.restoreData,clearData:b.fn.formKeeper.clearData},a,e),this.formId=b(this.element).data(this.options.formId),"undefined"==typeof this.formId?(c.console?c.console.error("Need formId!"):null,!1):(this.namespace=g+"."+this.formId,this._defaults=a,this._name=g,void this.init())}var g="formKeeper";f.prototype={init:function(){var a=this;this.options.restoreAtInit&&b(function(){a.restore()}),this.options.backupAtLeave&&b(c).on("beforeunload."+this.namespace,function(){a.backup()}),this.options.clearOnSubmit&&this.element.on("submit."+this.namespace,function(){a.clear()})},destroy:function(){this.options.backupAtLeave&&b(c).off("beforeunload."+this.namespace),this.options.clearOnSubmit&&this.element.off("submit."+this.namespace)},backup:function(){this.options.backupData(this.formId,this.options.backupForm(this.element))},restore:function(){this.options.restoreForm(this.element,this.options.restoreData(this.formId))},clear:function(){this.options.clearData(this.formId)}},b.fn[g]=function(a){var c=arguments;if(a===e||"object"==typeof a)return this.each(function(){b.data(this,"plugin_"+g)||b.data(this,"plugin_"+g,new f(this,a))});if("string"==typeof a&&"_"!==a[0]&&"init"!==a){var d;return this.each(function(){var e=b.data(this,"plugin_"+g);e instanceof f&&"function"==typeof e[a]&&(d=e[a].apply(e,Array.prototype.slice.call(c,1))),"destroy"===a&&b.data(this,"plugin_"+g,null)}),d!==e?d:this}},b.fn[g].backupForm=function(a){var c={input:{},checkbox:{},radio:{}};return b(a).find(":input").each(function(){var a=b(this),d=a.prop("name");if(d)if(a.is(":radio")){if(!a.prop("checked"))return;c.radio[d]=a.val()}else if(a.is(":checkbox")){if(!a.prop("checked"))return;c.checkbox[d]||(c.checkbox[d]=[]),c.checkbox[d].push(a.val())}else c.input[d]=a.val()}),c},b.fn[g].restoreForm=function(a,c){b(a).find(":input").each(function(){var a=b(this),d=a.prop("name");d&&(a.is(":radio")?c.radio[d]&&c.radio[d]===a.val()&&a.prop("checked",!0):a.is(":checkbox")?c.checkbox[d]&&-1!==c.checkbox[d].indexOf(a.val())&&a.prop("checked",!0):c.input[d]&&a.val(c.input[d]))})},b.fn[g].supportLocalStorage="object"==typeof c.localStorage,b.fn[g].backupData=function(a,d){b.fn[g].supportLocalStorage&&c.localStorage.setItem(g+"."+a,JSON.stringify(d))},b.fn[g].restoreData=function(a){return JSON.parse(c.localStorage.getItem(g+"."+a))},b.fn[g].clearData=function(a){c.localStorage.removeItem(g+"."+a)}}({formId:"formid",restoreAtInit:!0,backupAtLeave:!0,clearOnSubmit:!1},jQuery,window,document);